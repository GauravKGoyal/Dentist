@model dynamic

@using Dentist.ViewModels

<script src="~/Scripts/App_Script/CookieNames.js"></script>
<script src="~/Scripts/angular.js"></script>
<script src="~/Scripts/angular-route.js"></script>
<script src="~/Scripts/angular-cookies.js"></script>
<script src="~/Scripts/angular-ui/ui-bootstrap-tpls.js"></script>
<script src="~/Scripts/App_Script/app.js"></script>

<script src="~/Scripts/App_Script/Controllers/PatientNoteController.js"></script>
<script src="~/Scripts/App_Script/Controllers/PatientNoteModelController.js"></script>

@{
    ViewBag.LeftMenuSectionExist = true;
    var pageSizeArray = new[] { 20, 50, 100 };
}
<div ng-app="app">
    <div ng-controller="patientNoteController as ctrl">
        <button class="btn list-toolbar" ng-click="ctrl.add()">
            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add
        </button>
        <div class="list-panel list-panel-default" ng-repeat="patientNote in ctrl.patientNotes">
            <div class="list-panel-heading">
                <h3 class="list-panel-title">
                    {{patientNote.recordedDate}}
                    <span class="pull-right">
                        <button class="list-panel-heading-btn" ng-click="ctrl.edit(patientNote.id)">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </button> 
                        <button class="list-panel-heading-btn">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                        </button>
                    </span>
                </h3>
            </div>
            <div class="list-panel-record" ng-repeat="note in patientNote.notes">
                {{note.description}}
            </div>
        </div>

        <script type="text/ng-template" id="patientNoteModal.html">
            @*// this will get an instance or patientNoteModelController*@
            <div class="modal-header">
                <h3 class="modal-title">Todays notes</h3>
            </div>
            <form name ="frmPatientNote" novalidate>
                <div class="modal-body">
                    <button class="btn list-toolbar" ng-click="ctrl.add()">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add note
                    </button>
                    <div class="form-group" ng-repeat="note in ctrl.patientNote.notes | filter:{objectState : '!delete'} track by $index">
                        state = {{note.objectState}}
                        <div class="input-group">
                            <input type="text" class="form-control" ng-model="note.description" ng-change="ctrl.update(note)" required>
                            <span class="input-group-btn">
                                <button class="btn" type="button" ng-click="ctrl.delete($index); frmPatientNote.$dirty=true">
                                    <span class="glyphicon glyphicon-remove"></span>
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer clear-float">
                    <button class="btn btn-primary" type="submit" ng-click="frmPatientNote.$dirty ? ctrl.ok() : ctrl.cancel()">OK</button>
                    <button class="btn btn-warning" type="button" ng-click="ctrl.cancel()">Cancel</button>
                </div>
            </form>

        </script>

    </div>
</div>


